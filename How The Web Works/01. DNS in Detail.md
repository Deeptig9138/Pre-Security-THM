# DNS in Detail

> **Module Context**  
> DNS is one of the most critical (and most abused) systems on the Internet.  
> Understanding how DNS works is essential not only for networking, but also for:
> - Reconnaissance
> - Phishing
> - Subdomain enumeration
> - Infrastructure mapping

This room breaks DNS down from **human convenience** to **technical resolution flow**.

---

## Task 1: What is DNS?

### What is DNS?

DNS (**Domain Name System**) allows humans to access internet resources using **readable names** instead of numeric IP addresses.

Instead of remembering: `104.26.10.229`

We remember: `tryhackme.com` 

### Why DNS Exists

- Computers communicate using **IP addresses**
- Humans struggle to remember numbers
- DNS acts as a **phonebook for the Internet**

An IP address:
- Consists of **four octets**
- Each octet ranges from **0–255**
- Example: `104.26.10.229`
- DNS maps: `Domain Name → IP Address`

#### Answer
**What does DNS stand for?** - `Domain Name System`

---

## Task 2: Domain Hierarchy

DNS is structured hierarchically, starting from the **root domain** and branching downward.

![dns](https://github.com/Deeptig9138/Pre-Security-THM/blob/main/screenshots/dns%20hierarchy.gif)

### Top-Level Domain (TLD)

The **TLD** is the right-most part of a domain name.

Example:
```
tryhackme.com
↑
TLD
```

#### Types of TLDs

| Type | Meaning | Example |
|----|--------|--------|
| gTLD | Generic Top-Level Domain | .com, .org, .edu |
| ccTLD | Country Code Top-Level Domain | .uk, .ca, .in |

Example: `.co.uk → ccTLD`

### Second-Level Domain

This is the main name you register.

Example:
```
tryhackme.com
↑
Second-Level Domain
```

**Rules:**
- Max length: **63 characters**
- Allowed characters: `a-z`, `0-9`, `-`
- Cannot:
  - Start/end with `-`
  - Use consecutive hyphens

### Subdomains

Subdomains sit **to the left** of the Second-Level Domain.

Example:
```
admin.tryhackme.com
↑
Subdomain
```

You can stack subdomains: `jupiter.servers.tryhackme.com`

**Rules:**
- Max length per subdomain: **63 characters**
- Total domain length: **253 characters**
- Same character restrictions as second-level domains
- Unlimited number of subdomains allowed

#### Answers
**What is the maximum length of a subdomain?** - `63`

**Which of the following characters cannot be used in a subdomain ( 3 b _ - )?** -  `_`

**What is the maximum length of a domain name?** - `253`

**What type of TLD is .co.uk?** - `ccTLD`

---

## Task 3: DNS Record Types

DNS doesn’t only resolve websites — it supports **multiple services** using different record types.

### A Record
- Resolves to an **IPv4 address**
- Example: `104.26.10.229`

### AAAA Record
- Resolves to an **IPv6 address**
- Example: `2606:4700:20::681a:be5`

### CNAME Record
- Points one domain to **another domain**
- Requires a second lookup
- Example: `store.tryhackme.com → shops.shopify.com`

### MX Record
- Specifies **mail servers** for a domain
- Includes a **priority value**
- Lower value = higher priority
- Example: `alt1.aspmx.l.google.com (priority 10)`

### TXT Record
- Free-text record
- Common uses:
  - Email sender verification (SPF, DKIM)
  - Domain ownership verification
  - Security policies

#### Answers
**What type of record would be used to advise where to send email?** - `MX`

**What type of record handles IPv6 addresses?** - `AAAA`

---

## Task 4: Making a DNS Request

This task explains what **actually happens** when you type a URL into your browser.

### Step-by-Step DNS Resolution

1. **Local Cache Check**
   - Your device checks if it already knows the IP

2. **Recursive DNS Server**
   - Usually provided by your ISP
   - Checks its own cache

3. **Root DNS Servers**
   - Redirects to the correct TLD server
   - Example: `.com`

4. **TLD Server**
   - Points to the authoritative name server

5. **Authoritative DNS Server**
   - Holds the actual DNS records
   - Returns the requested record

6. **Caching**
   - Response cached using **TTL**
   - Reduces repeated lookups

### TTL (Time To Live)

- Value in **seconds**
- Determines how long a DNS record is cached
- Lower TTL = faster updates, more queries
- Higher TTL = fewer queries, slower changes

#### Answers
**What field specifies how long a DNS record should be cached for?** - `TTL`

**What type of DNS Server is usually provided by your ISP?** - `recursive`

**What type of server holds all the records for a domain?** - `authoritative`

---

## Task 5: Practical – DNS Queries

### Objective

Use the provided tool to:
- Build DNS queries
- Observe responses
- Understand record resolution in practice

#### Answers
**What is the CNAME of shop.website.thm?** - `shops.myshopify.com`

**What is the value of the TXT record of website.thm?** - `THM{7012BBA60997F35A9516C2E16D2944FF}`

**What is the numerical priority value for the MX record?** - `30`

**What is the IP address for the A record of www.website.thm?** - `10.10.10.10`

![prac](https://github.com/Deeptig9138/Pre-Security-THM/blob/main/screenshots/d1.png)

![prac1](https://github.com/Deeptig9138/Pre-Security-THM/blob/main/screenshots/d2.png)

---

## Key Takeaways

- DNS is a **distributed, hierarchical system**
- DNS enables human-friendly access to the Internet
- Records expose valuable infrastructure information
- Misconfigured DNS is a **goldmine for attackers**

---

## Security Mindset

> **If you control DNS, you control traffic.**

For defenders:
- Protect DNS records
- Monitor changes
- Secure email-related records

For attackers:
- Enumerate subdomains
- Identify third-party services
- Map infrastructure without touching the target

DNS is often the **first step in reconnaissance** — learn it deeply.
